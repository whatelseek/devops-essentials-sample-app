{
  "version": "2.4.1",
  "summary": {
    "title": "New Threat Model",
    "owner": "whatelse",
    "description": "",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "New STRIDE diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "DMZ",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "DMZ"
            ],
            "id": "96285ba1-a116-4836-8fb2-85fb52228dc8",
            "source": {
              "x": 240,
              "y": 10
            },
            "target": {
              "x": 360,
              "y": 570
            },
            "vertices": [
              {
                "x": 220,
                "y": 310
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "PaaS (External)",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "PaaS (External)"
            ],
            "id": "8a75ad32-ee61-4cc6-ba23-9a5307fe2caa",
            "source": {
              "x": 440,
              "y": 580
            },
            "target": {
              "x": 870,
              "y": 570
            },
            "vertices": [
              {
                "x": 470,
                "y": 450
              },
              {
                "x": 540,
                "y": 360
              },
              {
                "x": 650,
                "y": 320
              },
              {
                "x": 790,
                "y": 360
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "Trust Boundary"
            ],
            "id": "d01852df-3e8d-40ee-bd84-514d37730c92",
            "source": {
              "x": 430,
              "y": 0
            },
            "target": {
              "x": 850,
              "y": 0
            },
            "vertices": [
              {
                "x": 530,
                "y": 230
              },
              {
                "x": 760,
                "y": 230
              },
              {
                "x": 820,
                "y": 160
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTPS",
              "description": "User authenticates to platform, using login, password and 2FA",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "protocol": "HTTPS",
              "threats": []
            },
            "labels": [
              "HTTPS"
            ],
            "id": "bc5d88a3-948d-449f-a13c-81b449cc172c",
            "source": {
              "x": 133,
              "y": 96
            },
            "target": {
              "cell": "4d4c6273-2acb-4896-9b37-440fee3b0850",
              "port": "9f9a0b99-236a-469b-bedc-c60a31fbfd18"
            },
            "vertices": [
              {
                "x": 190,
                "y": 140
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Data Flow"
            ],
            "id": "58243026-3af5-40b2-9fef-50395336ad35",
            "source": {
              "x": 460,
              "y": 168
            },
            "target": {
              "cell": "60579222-e004-45db-9a5a-9fa3b145b318",
              "port": "9f9a0b99-236a-469b-bedc-c60a31fbfd18"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTPS",
              "description": "Load balancer (sticky sessions)",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "HTTPS"
            ],
            "id": "20fd9b66-71c9-472a-bfcc-6aeba541389c",
            "source": {
              "x": 300,
              "y": 168
            },
            "target": {
              "cell": "1df37a94-0696-4c21-af63-91fec8a6e7c9",
              "port": "9f9a0b99-236a-469b-bedc-c60a31fbfd18"
            },
            "vertices": [
              {
                "x": 340,
                "y": 168
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              ""
            ],
            "id": "a9a39da7-c2f0-4f5d-a69e-2d54329bd07f",
            "source": {
              "x": 290,
              "y": 400
            },
            "target": {
              "cell": "30bbfda0-bea1-49f5-80be-647448d8a5ee",
              "port": "7d658531-3ae4-422e-825c-004f37333f7c"
            },
            "vertices": [
              {
                "x": 210,
                "y": 470
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "HTTPS",
              "threats": []
            },
            "labels": [
              ""
            ],
            "id": "f8255e74-5d40-4145-9a80-9fb0e9b2accb",
            "source": {
              "cell": "60579222-e004-45db-9a5a-9fa3b145b318",
              "port": "fc2a34fb-0b4d-4efc-8401-ea2f57a0a4e6"
            },
            "target": {
              "cell": "65e70eea-9b1c-44a5-be45-09b6f4f0b721",
              "port": "b824b041-9f60-4b75-a064-8da528c69737"
            },
            "vertices": [
              {
                "x": 650,
                "y": 170
              },
              {
                "x": 740,
                "y": 270
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              ""
            ],
            "id": "5da7bb0c-5780-443c-b477-4d775ed35696",
            "source": {
              "cell": "60579222-e004-45db-9a5a-9fa3b145b318",
              "port": "fc2a34fb-0b4d-4efc-8401-ea2f57a0a4e6"
            },
            "target": {
              "cell": "f86857d9-3993-4f1d-9bd4-929669cac999",
              "port": "b824b041-9f60-4b75-a064-8da528c69737"
            },
            "vertices": [
              {
                "x": 590,
                "y": 390
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Data Flow"
            ],
            "id": "41491185-3a98-49df-bcb8-8a4e76a85523",
            "source": {
              "x": 620,
              "y": 80
            },
            "target": {
              "cell": "29cbfe7f-3ff8-473b-bf16-5a4c8466c5fa",
              "port": "f1810949-5d39-44bf-9ec2-3d0b746d33ae"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              ""
            ],
            "id": "9b4d996c-a32f-481e-a62b-8121eec11dec",
            "source": {
              "cell": "29cbfe7f-3ff8-473b-bf16-5a4c8466c5fa",
              "port": "fc2a34fb-0b4d-4efc-8401-ea2f57a0a4e6"
            },
            "target": {
              "cell": "de2ce787-5f54-4b06-b014-c96c623695db",
              "port": "f1810949-5d39-44bf-9ec2-3d0b746d33ae"
            }
          },
          {
            "position": {
              "x": 490,
              "y": 490
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "S3"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "b824b041-9f60-4b75-a064-8da528c69737"
                },
                {
                  "group": "right",
                  "id": "4900e815-5f54-4363-b71c-1ce7196f8648"
                },
                {
                  "group": "bottom",
                  "id": "b978c88c-df84-4a7f-9a4f-4f4a7dbe935a"
                },
                {
                  "group": "left",
                  "id": "50ffa818-5927-4c8a-9ab6-2204d1125311"
                }
              ]
            },
            "id": "f86857d9-3993-4f1d-9bd4-929669cac999",
            "data": {
              "type": "tm.Store",
              "name": "S3",
              "description": "Stores data from RAG",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": true,
              "threats": [
                {
                  "id": "d4531afc-a807-42e5-8a6e-a69ee00892f2",
                  "title": "Data theft",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "An attacker may compromise the credentials used in the backend and leverage them to steal sensitive information.",
                  "mitigation": "Least privilege\nSecrets management",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 3,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 680,
              "y": 490
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "PostgresSQL"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 12,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "b824b041-9f60-4b75-a064-8da528c69737"
                },
                {
                  "group": "right",
                  "id": "4900e815-5f54-4363-b71c-1ce7196f8648"
                },
                {
                  "group": "bottom",
                  "id": "b978c88c-df84-4a7f-9a4f-4f4a7dbe935a"
                },
                {
                  "group": "left",
                  "id": "50ffa818-5927-4c8a-9ab6-2204d1125311"
                }
              ]
            },
            "id": "65e70eea-9b1c-44a5-be45-09b6f4f0b721",
            "data": {
              "type": "tm.Store",
              "name": "PostgresSQL",
              "description": "Stores chat history",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": true,
              "threats": [
                {
                  "id": "8957bc38-5b0e-438b-8de4-bfbd6a311b54",
                  "title": "Data theft",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "An attacker may compromise the credentials used in the backend and leverage them to steal sensitive information.",
                  "mitigation": "Least privilege\nSecrets management",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 3,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 400,
              "y": 140
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Nginx"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 13,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ae05f8e5-4ce7-402b-a06b-9882a802835d"
                },
                {
                  "group": "right",
                  "id": "f1810949-5d39-44bf-9ec2-3d0b746d33ae"
                },
                {
                  "group": "bottom",
                  "id": "fc2a34fb-0b4d-4efc-8401-ea2f57a0a4e6"
                },
                {
                  "group": "left",
                  "id": "9f9a0b99-236a-469b-bedc-c60a31fbfd18"
                }
              ]
            },
            "id": "1df37a94-0696-4c21-af63-91fec8a6e7c9",
            "data": {
              "type": "tm.Process",
              "name": "Nginx",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "70be9b00-d836-48c0-8f8a-d6717e6d90d9",
                  "title": "HTTP Smuggling",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Spoofing",
                  "description": "The HTTP Request Smuggling attack explores an incomplete parsing of the submitted data done by an intermediary HTTP system working as a proxy. HTTP Request Smuggling consists of sending a specially formatted HTTP request that will be parsed in a different way by the proxy system and by the final system, so the attacker could smuggle a request to one system without the other being aware of it. This attack makes it possible to exploit other attacks, like Cache Poisoning, Session Hijacking, Cross-site Scripting (XSS) and most importantly, the ability to bypass web application firewall protection.",
                  "mitigation": "Do not allow both Content-Length and Transfer-Encoding\nUse HTTP/2 instead of HTTP/1.1\nSet proxy_request_buffering on",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 3,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 240,
              "y": 140
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "HAProxy"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ae05f8e5-4ce7-402b-a06b-9882a802835d"
                },
                {
                  "group": "right",
                  "id": "f1810949-5d39-44bf-9ec2-3d0b746d33ae"
                },
                {
                  "group": "bottom",
                  "id": "fc2a34fb-0b4d-4efc-8401-ea2f57a0a4e6"
                },
                {
                  "group": "left",
                  "id": "9f9a0b99-236a-469b-bedc-c60a31fbfd18"
                }
              ]
            },
            "id": "4d4c6273-2acb-4896-9b37-440fee3b0850",
            "data": {
              "type": "tm.Process",
              "name": "HAProxy",
              "description": "",
              "outOfScope": true,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 620,
              "y": 50
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "ML"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 15,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ae05f8e5-4ce7-402b-a06b-9882a802835d"
                },
                {
                  "group": "right",
                  "id": "f1810949-5d39-44bf-9ec2-3d0b746d33ae"
                },
                {
                  "group": "bottom",
                  "id": "fc2a34fb-0b4d-4efc-8401-ea2f57a0a4e6"
                },
                {
                  "group": "left",
                  "id": "9f9a0b99-236a-469b-bedc-c60a31fbfd18"
                }
              ]
            },
            "id": "60579222-e004-45db-9a5a-9fa3b145b318",
            "data": {
              "type": "tm.Process",
              "name": "ML",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "0f5b8070-b590-46b3-8099-5c5b162dca05",
                  "title": "Unbounded Consumption",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Attacks designed to disrupt service, deplete the target's financial resources, or even steal\nintellectual property by cloning a modelâ€™s behavior all depend on a common class of security\nvulnerability in order to succeed. Unbounded Consumption occurs when a Large Language Model\n(LLM) application allows users to conduct excessive and uncontrolled inferences, leading to risks\nsuch as denial of service (DoS), economic losses, model theft, and service degradation. The high\ncomputational demands of LLMs, especially in cloud environments, make them vulnerable to\nresource exploitation and unauthorized usage.",
                  "mitigation": "1. Input Validation\nImplement strict input validation to ensure that inputs do not exceed reasonable size limits.\n2. Limit Exposure of Logits and Logprobs\nRestrict or obfuscate the exposure of `logit_bias` and `logprobs` in API responses. Provide\nonly the necessary information without revealing detailed probabilities.\n3. Rate Limiting\nApply rate limiting and user quotas to restrict the number of requests a single source entity\ncan make in a given time period.\n4. Resource Allocation Management\nMonitor and manage resource allocation dynamically to prevent any single user or request from consuming excessive resources.\n5. Timeouts and Throttling\nSet timeouts and throttle processing for resource-intensive operations to prevent prolonged resource consumption.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                },
                {
                  "id": "5c137bb5-d166-4b8d-ba8f-8877eb19e2e0",
                  "title": "Supply Chain",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "LLM supply chains are susceptible to various vulnerabilities, which can affect the integrity of\ntraining data, models, and deployment platforms. These risks can result in biased outputs,\nsecurity breaches, or system failures. While traditional software vulnerabilities focus on issues\nlike code flaws and dependencies, in ML the risks also extend to third-party pre-trained models\nand data.",
                  "mitigation": "1. Apply comprehensive AI Red Teaming and Evaluations when selecting a third party model. Decoding Trust is an example of a Trustworthy AI benchmark for LLMs but models can finetuned to by pass published benchmarks. Use extensive AI Red Teaming to evaluate the model, especially in the use cases you are planning to use the model for.\n2. Maintain an up-to-date inventory of components using a Software Bill of Materials (SBOM) to ensure you have an up-to-date, accurate, and signed inventory, preventing tampering with deployed packages. SBOMs can be used to detect and alert for new, zero-date vulnerabilities quickly. AI BOMs and ML SBOMs are an emerging area and you should evaluate options starting with OWASP CycloneDX\n3. To mitigate AI licensing risks, create an inventory of all types of licenses involved using BOMs and conduct regular audits of all software, tools, and datasets, ensuring compliance and transparency through BOMs. Use automated license management tools for real-time monitoring and train teams on licensing models. Maintain detailed licensing documentation in BOMs.\n4. Only use models from verifiable sources and use third-party model integrity checks with signing and file hashes to compensate for the lack of strong model provenance. Similarly, use code signing for externally supplied code.\n5. Implement strict monitoring and auditing practices for collaborative model development environments to prevent and quickly detect any abuse. \"HuggingFace SF_Convertbot Scanner\" is an example of automated scripts to use. \n6. Anomaly detection and adversarial robustness tests on supplied models and data can help detect tampering and poisoning as discussed in \"LLM04 Data and Model Poisoning; ideally, this should be part of MLOps and LLM pipelines; however, these are emerging techniques and may be easier to implement as part of red teaming exercises.\n7. Implement a patching policy to mitigate vulnerable or outdated components. Ensure the application relies on a maintained version of APIs and underlying model.\n8. Encrypt models deployed at AI edge with integrity checks and use vendor attestation APIs to prevent tampered apps and models and terminate applications of unrecognized firmware.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 0
              }
            },
            "tools": {
              "items": [
                "boundary",
                "button-remove"
              ],
              "name": null
            }
          },
          {
            "position": {
              "x": 20,
              "y": 70
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "User"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 16,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "486c612e-bb81-4306-85ac-6c277c8a5c6d"
                },
                {
                  "group": "right",
                  "id": "7d658531-3ae4-422e-825c-004f37333f7c"
                },
                {
                  "group": "bottom",
                  "id": "67c1dc50-8ba1-4ea4-9250-0eef00fadbb3"
                },
                {
                  "group": "left",
                  "id": "4164fcdb-8e90-48b4-b9f0-73422088bb4d"
                }
              ]
            },
            "id": "025f08be-b02a-4bff-be1a-f7dbbeabff22",
            "data": {
              "type": "tm.Actor",
              "name": "User",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 510,
              "y": 150
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "API"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 17,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ae05f8e5-4ce7-402b-a06b-9882a802835d"
                },
                {
                  "group": "right",
                  "id": "f1810949-5d39-44bf-9ec2-3d0b746d33ae"
                },
                {
                  "group": "bottom",
                  "id": "fc2a34fb-0b4d-4efc-8401-ea2f57a0a4e6"
                },
                {
                  "group": "left",
                  "id": "9f9a0b99-236a-469b-bedc-c60a31fbfd18"
                }
              ]
            },
            "id": "29cbfe7f-3ff8-473b-bf16-5a4c8466c5fa",
            "data": {
              "type": "tm.Process",
              "name": "API",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 290,
              "y": 370
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "HAProxy"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 18,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ae05f8e5-4ce7-402b-a06b-9882a802835d"
                },
                {
                  "group": "right",
                  "id": "f1810949-5d39-44bf-9ec2-3d0b746d33ae"
                },
                {
                  "group": "bottom",
                  "id": "fc2a34fb-0b4d-4efc-8401-ea2f57a0a4e6"
                },
                {
                  "group": "left",
                  "id": "9f9a0b99-236a-469b-bedc-c60a31fbfd18"
                }
              ]
            },
            "id": "de2ce787-5f54-4b06-b014-c96c623695db",
            "data": {
              "type": "tm.Process",
              "name": "HAProxy",
              "description": "",
              "outOfScope": true,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 20,
              "y": 490
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Data Sources"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 19,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "486c612e-bb81-4306-85ac-6c277c8a5c6d"
                },
                {
                  "group": "right",
                  "id": "7d658531-3ae4-422e-825c-004f37333f7c"
                },
                {
                  "group": "bottom",
                  "id": "67c1dc50-8ba1-4ea4-9250-0eef00fadbb3"
                },
                {
                  "group": "left",
                  "id": "4164fcdb-8e90-48b4-b9f0-73422088bb4d"
                }
              ]
            },
            "id": "30bbfda0-bea1-49f5-80be-647448d8a5ee",
            "data": {
              "type": "tm.Actor",
              "name": "Data Sources",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "e3c73349-64ab-44ba-b2bb-414c359d4a0c",
                  "title": "Model Poisoning",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Spoofing",
                  "description": "Data poisoning occurs when pre-training, fine-tuning, or embedding data is manipulated to\nintroduce vulnerabilities, backdoors, or biases. This manipulation can compromise model\nsecurity, performance, or ethical behavior, leading to harmful outputs or impaired capabilities.\nCommon risks include degraded model performance, biased or toxic content, and exploitation of\ndownstream systems.",
                  "mitigation": "1. Track data origins and transformations using tools like OWASP CycloneDX or ML-BOM. Verify\ndata legitimacy during all model development stages.\n2. Vet data vendors rigorously, and validate model outputs against trusted sources to detect\nsigns of poisoning.\n3. Implement strict sandboxing to limit model exposure to unverified data sources. Use\nanomaly detection techniques to filter out adversarial data.\n4. Tailor models for different use cases by using specific datasets for fine-tuning. This helps\nproduce more accurate outputs based on defined goals.\n5. Ensure sufficient infrastructure controls to prevent the model from accessing unintended\ndata sources.\n6. Use data version control (DVC) to track changes in datasets and detect manipulation.\nVersioning is crucial for maintaining model integrity.\n7. Store user-supplied information in a vector database, allowing adjustments without retraining\nthe entire model.\n8. Test model robustness with red team campaigns and adversarial techniques, such as\nfederated learning, to minimize the impact of data perturbations.\n9. Monitor training loss and analyze model behavior for signs of poisoning. Use thresholds to\ndetect anomalous outputs.\n10. During inference, integrate Retrieval-Augmented Generation (RAG) and grounding\ntechniques to reduce risks of hallucinations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "repudiation": 0
              }
            }
          }
        ],
        "description": "test"
      }
    ],
    "diagramTop": 1,
    "reviewer": "",
    "threatTop": 8
  }
}